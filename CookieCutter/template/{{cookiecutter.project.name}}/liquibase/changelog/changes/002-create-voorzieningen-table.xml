<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.25.xsd">

    <changeSet id="002-create-voorzieningen-table" author="wateralmanak">
        <sql>
            CREATE TABLE wateralmanak.voorzieningen (
                id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
                naam VARCHAR(255) NOT NULL,
                beschrijving TEXT,
                locatie GEOMETRY(Point, 4326),
                created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
                updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
            );

            CREATE INDEX idx_voorzieningen_locatie ON wateralmanak.voorzieningen USING GIST(locatie);
            CREATE INDEX idx_voorzieningen_naam ON wateralmanak.voorzieningen(naam);

            -- Insert sample data
            INSERT INTO wateralmanak.voorzieningen (naam, beschrijving, locatie) VALUES
            ('Waterpomp Rotterdam', 'Hoofdwaterpomp centrum', ST_SetSRID(ST_MakePoint(4.4777, 51.9225), 4326)),
            ('Sluis Kinderdijk', 'Historische sluis', ST_SetSRID(ST_MakePoint(4.6395, 51.8833), 4326)),
            ('Waterzuivering Delft', 'Moderne zuiveringsinstallatie', ST_SetSRID(ST_MakePoint(4.3571, 52.0116), 4326));
        </sql>
        <rollback>
            DROP TABLE IF EXISTS wateralmanak.voorzieningen;
        </rollback>
    </changeSet>

</databaseChangeLog>
